R = [0.25 + 2.5i; (0.5 * (-20i)) / (0.5 - 20i); 0.5; 1];
E = [1; 1; 7];
J = [6];
U = zeros(7, 1);
I = zeros(7, 1);

U(1) = (J(1) * R(4) * R(2) + E(3) * R(2) - R(2)) / (R(4) + R(2));
U(2) = U(1) + 1;
U(3) = U(1) + 1;
U(4) = 1;
U(5) = 1;
U(6) = 1;
U(7) = 1;

I(1) = U(1) / R(2);
I(2) = (-U(2) + E(3)) / R(4);
I(3) = 6;
I(7) = U(7) / R(1);
I(4) = I(3) + I(7) - I(1);
I(6) = U(6) / R(3);
I(5) = I(3) - I(6);

I_conj = conj(I);
S_c = R(1) * (abs(I(7)))^2 + R(2) * (abs(I(1)))^2 + R(3) * (abs(I(6)))^2
S_g = -I_conj(4) * E(1) + I_conj(5) * E(2) - I_conj(2) * E(3) + J(1) * U(3)